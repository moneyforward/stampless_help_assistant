# ğŸš€ Google Slides APIé€£æºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ æ¦‚è¦

Google Slides APIã‚’ä½¿ç”¨ã—ã¦ã€æ–°ãƒªãƒ¼ã‚¹ä¼šè¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’è‡ªå‹•ã§å–å¾—ãƒ»æ›´æ–°ã™ã‚‹æ©Ÿèƒ½ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã§ã™ã€‚

### âœ… **å®Ÿç¾ã§ãã‚‹ã“ã¨**
- ğŸ“„ Google Slidesã‹ã‚‰æœ€æ–°ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³æƒ…å ±ã‚’è‡ªå‹•å–å¾—
- ğŸ”„ é¡§å®¢å…±æœ‰å¯å¦åˆ¤å®šã®è‡ªå‹•æ›´æ–°
- âš¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã®æƒ…å ±åæ˜ 
- ğŸ“Š æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã§ã®ç®¡ç†

---

## âš¡ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### **Step 1: Google Cloud Platformè¨­å®š**

#### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
1. [Google Cloud Console](https://console.cloud.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã¾ãŸã¯æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: `stampless-help-assistant` ãªã©

#### 1.2 Google Slides APIæœ‰åŠ¹åŒ–
1. ã€ŒAPIã¨ã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€
2. ã€ŒGoogle Slides APIã€ã‚’æ¤œç´¢
3. APIã‚’æœ‰åŠ¹åŒ–

### **Step 2: ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ**

#### 2.1 ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š
1. ã€ŒAPIã¨ã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œèªè¨¼æƒ…å ±ã€
2. ã€Œèªè¨¼æƒ…å ±ã‚’ä½œæˆã€â†’ã€Œã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€
3. **ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå**: `slides-reader`
4. **èª¬æ˜**: `æ–°ãƒªãƒ¼ã‚¹ä¼šè¨ˆSlidesèª­ã¿å–ã‚Šç”¨`
5. å½¹å‰²ã¯è¨­å®šä¸è¦ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã¾ã¾ï¼‰

#### 2.2 ã‚­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
1. ä½œæˆã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œã‚­ãƒ¼ã€ã‚¿ãƒ–â†’ã€Œã‚­ãƒ¼ã‚’è¿½åŠ ã€â†’ã€Œæ–°ã—ã„ã‚­ãƒ¼ã‚’ä½œæˆã€
3. **å½¢å¼**: JSON
4. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã«é…ç½®:
   ```
   config/google-api-credentials.json
   ```

### **Step 3: Google Slidesã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ä»˜ä¸**

#### 3.1 Slidesã«æ¨©é™è¿½åŠ 
1. [æ–°ãƒªãƒ¼ã‚¹ä¼šè¨ˆSlides](https://docs.google.com/presentation/d/1e9xoZB8VqfD4FsRH-eM5OPElTF8NIgs5NbZNh8ZSgEw/edit)ã‚’é–‹ã
2. å³ä¸Šã®ã€Œå…±æœ‰ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿½åŠ 
   - **ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹**: `credentials.json`ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®`client_email`ã®å€¤
   - **æ¨©é™**: é–²è¦§è€…
4. ã€Œé€ä¿¡ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

### **Step 4: ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

```bash
# googleapis ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install googleapis
```

### **Step 5: å‹•ä½œãƒ†ã‚¹ãƒˆ**

```bash
# è¨­å®šç¢ºèª
npm run slides-setup

# åˆå›åŒæœŸå®Ÿè¡Œ
npm run slides-sync

# åŒæœŸçŠ¶æ³ç¢ºèª
npm run slides-status
```

---

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### **åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰**

```bash
# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰è¡¨ç¤º
npm run slides-setup

# Google Slidesã‹ã‚‰æœ€æ–°æƒ…å ±ã‚’åŒæœŸ
npm run slides-sync

# ç¾åœ¨ã®åŒæœŸçŠ¶æ³ã‚’ç¢ºèª
npm run slides-status
```

### **ç›´æ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ**

```bash
# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
node scripts/google-slides-api.js --setup

# åŒæœŸå®Ÿè¡Œ
node scripts/google-slides-api.js --sync

# çŠ¶æ³ç¢ºèª
node scripts/google-slides-api.js --status
```

---

## ğŸ“Š è‡ªå‹•æŠ½å‡ºã•ã‚Œã‚‹æƒ…å ±

### **æŠ½å‡ºé …ç›®**
Google Slidesã‹ã‚‰ä»¥ä¸‹ã®æƒ…å ±ã‚’è‡ªå‹•æŠ½å‡ºã—ã€æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿å­˜ï¼š

#### âœ… **é¡§å®¢å…±æœ‰OK**
- æ–°ãƒªãƒ¼ã‚¹ä¼šè¨ˆåŸºæº–ã®èª¬æ˜
- å¯¾å¿œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆç¢ºå®šæ¸ˆã¿ï¼‰
- æ©Ÿèƒ½ã®åˆ©ç”¨æ–¹æ³•ãƒ»æ“ä½œæ‰‹é †
- æ—¢å­˜æ©Ÿèƒ½ã‹ã‚‰ã®ç§»è¡Œæ‰‹é †

#### âŒ **é¡§å®¢å…±æœ‰NG**
- å†…éƒ¨é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
- æŠ€è¡“çš„å®Ÿè£…è©³ç´°
- ä»–ç¤¾ã¨ã®å·®åˆ¥åŒ–æˆ¦ç•¥
- æœªç¢ºå®šã®æ©Ÿèƒ½ä»•æ§˜

#### ğŸš¨ **ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¿…è¦**
- æ³•çš„è²¬ä»»ã«é–¢ã‚ã‚‹åˆ¤æ–­
- ç›£æŸ»å¯¾å¿œã«é–¢ã™ã‚‹å…·ä½“çš„æ‰‹é †
- ä»–ç¤¾è£½å“ã¨ã®è©³ç´°æ¯”è¼ƒ
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºé–‹ç™ºã®å¯å¦

#### ğŸ“… **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æƒ…å ±**
- ãƒªãƒªãƒ¼ã‚¹äºˆå®šæ—¥
- å¯¾å¿œå®Œäº†æ™‚æœŸ
- ç§»è¡ŒæœŸé–“

#### ğŸ”§ **æ©Ÿèƒ½æƒ…å ±**
- æ–°æ©Ÿèƒ½ã®èª¬æ˜
- å¯¾å¿œç¯„å›²
- å®Ÿè£…çŠ¶æ³

---

## ğŸ”„ è‡ªå‹•æ›´æ–°ãƒ•ãƒ­ãƒ¼

### **Step 1: Google Slidesæ›´æ–°**
```
æ‹…å½“è€…ãŒGoogle Slidesã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³è³‡æ–™ã‚’æ›´æ–°
```

### **Step 2: åŒæœŸå®Ÿè¡Œ**
```bash
# æ‰‹å‹•åŒæœŸ
npm run slides-sync

# ã¾ãŸã¯å®šæœŸå®Ÿè¡Œï¼ˆcronè¨­å®šï¼‰
0 9 * * * cd /path/to/project && npm run slides-sync
```

### **Step 3: è‡ªå‹•åæ˜ **
```
æ¬¡å›ã®help_request_assistantå®Ÿè¡Œæ™‚ã«æœ€æ–°æƒ…å ±ãŒé©ç”¨ã•ã‚Œã‚‹
```

---

## ğŸ“± å®šæœŸå®Ÿè¡Œè¨­å®šï¼ˆæ¨å¥¨ï¼‰

### **Cronã«ã‚ˆã‚‹è‡ªå‹•å®Ÿè¡Œ**

```bash
# crontabã®ç·¨é›†
crontab -e

# æ¯æ—¥æœ9æ™‚ã«è‡ªå‹•åŒæœŸ
0 9 * * * cd /Users/sudo.ryota/Documents/workspace/stampless_help_assistant && npm run slides-sync >> logs/slides-sync.log 2>&1

# æ¯é€±æœˆæ›œæ—¥ã®æœ9æ™‚ã«å®Ÿè¡Œ
0 9 * * 1 cd /Users/sudo.ryota/Documents/workspace/stampless_help_assistant && npm run slides-sync
```

### **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**

```bash
# ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p logs

# ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åˆæœŸåŒ–
touch logs/slides-sync.log
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### **ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•**

#### âŒ **403 Forbidden ã‚¨ãƒ©ãƒ¼**
```
Error: The caller does not have permission
```
**å¯¾å‡¦æ³•**:
1. Google Slidesã®å…±æœ‰è¨­å®šã‚’ç¢ºèª
2. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ãè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. æ¨©é™ãŒã€Œé–²è¦§è€…ã€ä»¥ä¸Šã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### âŒ **404 Not Found ã‚¨ãƒ©ãƒ¼**
```
Error: Requested entity was not found
```
**å¯¾å‡¦æ³•**:
1. Slides IDãŒæ­£ã—ã„ã‹ç¢ºèª
2. SlidesãŒå‰Šé™¤ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
3. URLãŒæ­£ã—ã„ã‹ç¢ºèª

#### âŒ **èªè¨¼ã‚¨ãƒ©ãƒ¼**
```
Error: invalid_grant
```
**å¯¾å‡¦æ³•**:
1. `google-api-credentials.json`ã®å†…å®¹ã‚’ç¢ºèª
2. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’å†ä½œæˆ
3. ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèª

#### âŒ **ä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼**
```
Cannot find module 'googleapis'
```
**å¯¾å‡¦æ³•**:
```bash
npm install googleapis
```

---

## ğŸ“Š è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

### **èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ä¾‹**
```json
{
  "type": "service_account",
  "project_id": "your-project-id",
  "private_key_id": "your-private-key-id",
  "private_key": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n",
  "client_email": "slides-reader@your-project.iam.gserviceaccount.com",
  "client_id": "your-client-id",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/...",
  "universe_domain": "googleapis.com"
}
```

### **å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿æ§‹é€ **
```json
{
  "last_updated": "2024-01-20T09:00:00.000Z",
  "slides_url": "https://docs.google.com/presentation/d/...",
  "slides_content": {
    "title": "æ–°ãƒªãƒ¼ã‚¹ä¼šè¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³",
    "total_slides": 15,
    "last_modified": "2024-01-20T09:00:00.000Z"
  },
  "guidelines": {
    "customer_sharing_ok": [...],
    "customer_sharing_ng": [...],
    "escalation_required": [...],
    "schedule_info": [...],
    "feature_info": [...]
  },
  "update_history": [...]
}
```

---

## ğŸ¯ é‹ç”¨ã®ãƒã‚¤ãƒ³ãƒˆ

### **å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**
- **é€±1å›**: åŒæœŸçŠ¶æ³ã®ç¢ºèª
- **æœˆ1å›**: Google Slideså†…å®¹ã®æ‰‹å‹•ç¢ºèª
- **å››åŠæœŸ1å›**: ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã®æ›´æ–°æ¤œè¨

### **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
- ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã¯é©åˆ‡ã«ç®¡ç†
- æœ€å°æ¨©é™ã®åŸå‰‡ï¼ˆé–²è¦§è€…æ¨©é™ã®ã¿ï¼‰
- å®šæœŸçš„ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç¢ºèª

### **ç›£è¦–**
- åŒæœŸå¤±æ•—æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å®šæœŸç¢ºèª
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ç¢ºèª

---

## ğŸ† å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸

### **Beforeï¼ˆæ‰‹å‹•æ›´æ–°ï¼‰**
```
Google Slidesæ›´æ–° â†’ æ‰‹å‹•ã§ã‚³ãƒ”ãƒš â†’ JSONæ‰‹å‹•ç·¨é›† â†’ ã‚·ã‚¹ãƒ†ãƒ åæ˜ 
æ‰€è¦æ™‚é–“: 30åˆ†ã€œ1æ™‚é–“
```

### **Afterï¼ˆè‡ªå‹•åŒæœŸï¼‰**
```
Google Slidesæ›´æ–° â†’ npm run slides-sync â†’ è‡ªå‹•ã§ã‚·ã‚¹ãƒ†ãƒ åæ˜ 
æ‰€è¦æ™‚é–“: 1åˆ†
```

**ä½œæ¥­åŠ¹ç‡ãŒåŠ‡çš„ã«å‘ä¸Šï¼** ğŸš€
