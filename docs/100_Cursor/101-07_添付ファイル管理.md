# 添付ファイル管理

## 概要

**attachments**フォルダは、知識管理システム内で使用する画像、PDF、音声ファイルなどのバイナリファイルを保存するための場所です。リポジトリのサイズ管理とファイル参照の一貫性を確保するために重要な役割を果たします。

## 基本構造

```
attachments/
├─ images/       # 画像ファイル
│   ├─ png/      # PNG形式の画像
│   ├─ jpg/      # JPEG形式の画像
│   └─ svg/      # SVG形式の画像
├─ documents/    # PDF等のドキュメント
├─ audio/        # 音声ファイル
└─ misc/         # その他のファイル
```

※ 注：実際の使用状況によってサブフォルダ構造はカスタマイズ可能です。

## 運用ルール

1. **一元管理**: 全ての添付ファイルは`attachments`フォルダに集約
2. **Obsidian設定**: Obsidianの設定で「ファイルの添付フォルダのパス」を`attachments`に指定
3. **サイズ制限**: 大きなファイルはGit LFSで管理または外部ストレージへのリンクを検討
4. **圧縮活用**: 画像ファイルは可能な限り圧縮して保存

## ファイル命名規則

- 基本形式: `YYYYMMDD_説明的な名前.拡張子`
- 例: `20230521_知識管理システム図.png`
- スペースの代わりにアンダースコア（\_）を使用
- 日本語ファイル名も可能だが、一貫性を保つ

## Git LFSの活用

リポジトリサイズを管理するために、Git Large File Storage (LFS) の使用を推奨します。

### Git LFS設定例

`.gitattributes`ファイルに以下のような設定を追加：

```
*.pdf filter=lfs diff=lfs merge=lfs -text
*.jpg filter=lfs diff=lfs merge=lfs -text
*.jpeg filter=lfs diff=lfs merge=lfs -text
*.png filter=lfs diff=lfs merge=lfs -text
*.mp3 filter=lfs diff=lfs merge=lfs -text
*.mp4 filter=lfs diff=lfs merge=lfs -text
```

### Git LFSのインストールと初期化

```bash
# Git LFSのインストール
git lfs install

# トラッキング設定の適用
git lfs track "*.pdf"
git lfs track "*.jpg"
git lfs track "*.png"
git lfs track "*.mp3"
git lfs track "*.mp4"

# .gitattributesをコミット
git add .gitattributes
git commit -m "[CONFIG] Add Git LFS tracking for binary files"
```

## 外部ストレージ連携の選択肢

非常に大きなファイルや多数のバイナリファイルを扱う場合は、以下の方法も検討できます：

1. **クラウドストレージリンク**: Google Drive, Dropboxなどへのリンク
2. **シンボリックリンク**: 外部フォルダへのシンボリックリンク設定
3. **専用メディアサーバー**: 画像・動画専用のサーバーを使用

## Obsidianでの添付ファイル設定

Obsidianの設定で添付ファイルの扱いを指定します：

1. 設定 > ファイルとリンク > 「新しく作成される添付ファイルのデフォルトの場所」を「添付ファイル用に指定されたフォルダ」に設定
2. 「ファイルの添付フォルダのパス」を`attachments`に設定
3. 「画像をペーストする時」を「attachmentsフォルダに添付ファイルとして保存」に設定

## 添付ファイル参照のベストプラクティス

- マークダウンリンク形式を使用する: `![説明](../attachments/images/ファイル名.png)`
- 相対パスではなく、ルートからのパスを使用する（Obsidianの設定で対応）
- ファイル名は説明的かつユニークなものを使用
- 未使用の添付ファイルを定期的に整理（Obsidianの「未使用の添付ファイル」プラグインが便利）

## 自動化ポイント

- 画像ファイルの自動圧縮（Obsidianプラグインまたはスクリプト）
- 添付ファイルの命名規則自動適用
- Webクリップからの画像自動ダウンロードと保存
- 定期的な未使用添付ファイルのクリーンアップ
